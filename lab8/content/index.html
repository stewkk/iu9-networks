<!DOCTYPE html>
<html lang="en">
  <head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/highlight.js/latest/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/latest/styles/github.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
    <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
  </head>
  <body>
    <div class="container p-4">

      <form>
        <div class="row">
          <div class="col-4">

            <div class="form-group">
              <label for="jobTypeInput">Тип работы</label>
              <input type="text" name="jobType" class="form-control" id="jobTypeInput" placeholder="">
            </div>

            <div class="form-group mt-2">
              <label for="jobNameInput">Название</label>
              <input type="text" name="jobName" class="form-control" id="jobNameInput" placeholder="">
            </div>

            <div class="form-group mt-2">
              <label for="authorInput">Автор</label>
              <input type="text" name="author" class="form-control" id="authorInput" placeholder="">
            </div>

            <div class="form-group mt-2">
              <label for="teacherInput">Преподаватель</label>
              <input type="text" name="teacher" class="form-control" id="teacherInput" placeholder="">
            </div>

            <div class="form-group mt-2">
              <label for="groupInput"> Группа </label>
              <input type="text" name="group" class="form-control" id="groupInput" placeholder="">
            </div>
            <div class="form-group mt-2">
              <label for="groupInput"> Курс </label>
              <input type="text" name="course" class="form-control" id="groupInput" placeholder="">
            </div>

            <div class="form-group mt-2">
              <label for="groupInput"> Номер </label>
              <input type="text" name="number" class="form-control" id="groupInput" placeholder="">
            </div>
          </div>
          <div class="form-group col-8 mt-4">
            <div class="row">
              <textarea id="reportEditor" name="report"></textarea>
            </div>
            <div class="d-flex flex-row justify-content-end">
              <button type="submit" id="sendReportBtn" class="btn btn-secondary mt-3"> Отправить </button>
            </div>
          </div>
      </form>

        </div>
    </div>
    <script>
      function Download(url) {
          var link = document.createElement("a")
          link.download=url
          link.href = url
          document.body.appendChild(link)
          link.click()
          link.remove()
      };

      let simplemde = new SimpleMDE({
          element: document.getElementById("reportEditor"),
          renderingConfig: {
              codeSyntaxHighlighting: true,
          },
          spellChecker: false,
      });
      const URL = "/"
      const form = document.querySelector("form")
      form.addEventListener("submit", async (event) => {
          const { currentTarget } = event;
          event.preventDefault()
          const formData = new FormData(form)
          let response = await fetch(URL, {
              method: "POST",
              headers: {
                  'Content-Type': 'application/json;charset=utf-8'
              },
              body: JSON.stringify(Object.fromEntries(formData))
          });

          let pdf = await response.json();
          Download(pdf.url);
      })
    </script>

  </body>
</html>
